<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Riconosci l'articolo â€“ 5 Test (Aâ€“E)</title>
<style>
  :root{--bg:#0b0f14;--card:#121821;--muted:#9fb0c3;--text:#e9f0f7;--accent:#5cc8ff;--ok:#18c29c;--bad:#ff6b6b;}
  *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text);}
  header{position:sticky;top:0;z-index:10;background:linear-gradient(180deg,rgba(11,15,20,.95),rgba(11,15,20,.6) 70%,transparent);backdrop-filter:blur(8px);}
  .wrap{max-width:1080px;margin:0 auto;padding:16px 20px;}
  h1{margin:8px 0;font-size:clamp(1.2rem,2.6vw,1.8rem)}
  .small{color:var(--muted);font-size:.95rem}
  .tests{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .tab{padding:10px 14px;border:1px solid #2a3544;border-radius:999px;background:#0f141c;color:var(--muted);cursor:pointer}
  .tab.active{background:var(--accent);color:#001822;border-color:transparent;font-weight:700}
  .card{background:var(--card);border:1px solid #273241;border-radius:16px;padding:16px;margin:14px 0;box-shadow:0 6px 30px rgba(0,0,0,.25)}
  .qtext{white-space:pre-wrap;line-height:1.5}
  .opts{display:grid;gap:8px;margin:12px 0}
  .opt{display:flex;gap:10px;align-items:flex-start;padding:10px 12px;border:1px solid #2b3646;border-radius:12px;cursor:pointer}
  .opt.correct{border-color:rgba(24,194,156,.6);background:rgba(24,194,156,.08)}
  .opt.wrong{border-color:rgba(255,107,107,.6);background:rgba(255,107,107,.08)}
  .controls{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0}
  button{border:1px solid #2b3646;background:#0f141c;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer}
  button.primary{background:var(--accent);color:#001822;border-color:transparent;font-weight:700}
  .pill{font-size:.85rem;padding:6px 10px;border-radius:999px;border:1px solid #2b3646;color:var(--muted)}
  .ref{font-size:.85rem;color:var(--muted)}
  .divider{height:1px;background:#223042;margin:14px 0}
  .footer{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap;margin-top:12px}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Riconosci lâ€™articolo â€“ 5 Test (Aâ€“E)</h1>
    <div class="small">Ogni test contiene 42 domande (una per articolo). Le opzioni sono mescolate e diverse tra i test.</div>
    <div class="tests" id="test-tabs"></div>
  </div>
</header>

<main class="wrap" id="app"></main>

<template id="tpl">
  <section class="card">
    <h2></h2>
    <div class="controls">
      <button class="primary" data-action="check">Correggi tutto</button>
      <button data-action="reset">Azzera risposte</button>
      <button data-action="export">Esporta CSV</button>
      <span class="pill">Punteggio: <b data-score>0</b>/<span data-total>0</span></span>
    </div>
    <div class="divider"></div>
    <div class="questions"></div>
    <div class="footer small">Suggerimento: leggi il testo e indica a quale Articolo appartiene.</div>
  </section>
</template>

<script>
  const ARTICOLI = [{"num": 1, "text": "Le regole del presente Codice Deontologico sono vincolanti per tutti gli iscritti allâ€™Albo degli psicologi. Lo psicologo Ã¨ tenuto alla loro conoscenza e lâ€™ignoranza delle medesime non esime dalla responsabilitÃ  disciplinare. Le stesse regole si applicano anche nei casi in cui le prestazioni, o parti di esse, vengano effettuate a distanza, via Internet o con qualunque altro mezzo elettronico e/o telematico."}, {"num": 2, "text": "Lâ€™inosservanza dei precetti stabiliti nel presente Codice deontologico, ed ogni azione od omissione comunque contrarie al decoro, alla dignitÃ  ed al corretto esercizio della professione, sono punite secondo quanto previsto dallâ€™art. 26, comma 1Â°, della Legge 18 febbraio 1989, n. 56, secondo le procedure stabilite dal Regolamento disciplinare."}, {"num": 3, "text": "Lo psicologo considera suo dovere accrescere le conoscenze sul comportamento umano ed utilizzarle per promuovere il benessere psicologico dellâ€™individuo, del gruppo e della comunitÃ . In ogni ambito professionale opera per migliorare la capacitÃ  delle persone di comprendere se stessi e gli altri e di comportarsi in maniera consapevole, congrua ed efficace. Lo psicologo Ã¨ consapevole della responsabilitÃ  sociale derivante dal fatto che, nellâ€™esercizio professionale, puÃ² intervenire significativamente nella vita degli altri; pertanto deve prestare particolare attenzione ai fattori personali, sociali, organizzativi, finanziari e politici, al fine di evitare lâ€™uso non appropriato della sua influenza, e non utilizza indebitamente la fiducia e le eventuali situazioni di dipendenza dei committenti e degli utenti destinatari della sua prestazione professionale. Lo psicologo Ã¨ responsabile dei propri atti professionali e delle loro prevedibili dirette conseguenze."}, {"num": 4, "text": "Nellâ€™esercizio della professione, lo psicologo rispetta la dignitÃ , il diritto alla riservatezza, allâ€™autodeterminazione ed allâ€™autonomia di coloro che si avvalgono delle sue prestazioni; ne rispetta opinioni e credenze, astenendosi dallâ€™imporre il suo sistema di valori; non opera discriminazioni in base a religione, etnia, nazionalitÃ , estrazione sociale, stato socio-economico, sesso di appartenenza, orientamento sessuale, disabilitÃ . Lo psicologo utilizza metodi e tecniche salvaguardando tali principi, e rifiuta la sua collaborazione ad iniziative lesive degli stessi. Quando sorgono conflitti di interesse tra lâ€™utente e lâ€™istituzione presso cui lo psicologo opera, questâ€™ultimo deve esplicitare alle parti, con chiarezza, i termini delle proprie responsabilitÃ  ed i vincoli cui Ã¨ professionalmente tenuto. In tutti i casi in cui il destinatario ed il committente dellâ€™intervento di sostegno o di psicoterapia non coincidano, lo psicologo tutela prioritariamente il destinatario dellâ€™intervento stesso."}, {"num": 5, "text": "Lo psicologo Ã¨ tenuto a mantenere un livello adeguato di preparazione e aggiornamento professionale, con particolare riguardo ai settori nei quali opera. La violazione dellâ€™obbligo di formazione continua, determina un illecito disciplinare che Ã¨ sanzionato sulla base di quanto stabilito dallâ€™ordinamento professionale. Riconosce i limiti della propria competenza e usa, pertanto solo strumenti teorico â€“ pratici per i quali ha acquisito adeguata competenza e, ove necessario, formale autorizzazione. Lo psicologo impiega metodologie delle quali Ã¨ in grado di indicare le fonti e riferimenti scientifici, e non suscita, nelle attese del cliente e/o utente, aspettative infondate."}, {"num": 6, "text": "Lo psicologo accetta unicamente condizioni di lavoro che non compromettano la sua autonomia professionale ed il rispetto delle norme del presente codice, e, in assenza di tali condizioni, informa il proprio Ordine. Lo psicologo salvaguarda la propria autonomia nella scelta dei metodi, delle tecniche e degli strumenti psicologici, nonchÃ© della loro utilizzazione; Ã¨ perciÃ² responsabile della loro applicazione ed uso, dei risultati, delle valutazioni ed interpretazioni che ne ricava. Nella collaborazione con professionisti di altre discipline esercita la piena autonomia professionale nel rispetto delle altrui competenze."}, {"num": 7, "text": "Nelle proprie attivitÃ  professionali, nelle attivitÃ  di ricerca e nelle comunicazioni dei risultati delle stesse, nonchÃ© nelle attivitÃ  didattiche, lo psicologo valuta attentamente, anche in relazione al contesto, il grado di validitÃ  e di attendibilitÃ  di informazioni, dati e fonti su cui basa le conclusioni raggiunte; espone, allâ€™occorrenza, le ipotesi interpretative alternative, ed esplicita i limiti dei risultati. Lo psicologo, su casi specifici, esprime valutazioni e giudizi professionali solo se fondati sulla conoscenza professionale diretta ovvero su una documentazione adeguata ed attendibile."}, {"num": 8, "text": "Lo psicologo contrasta lâ€™esercizio abusivo della professione come definita dagli articoli 1 e 3 della Legge 18 febbraio 1989, n. 56, e segnala al Consiglio dellâ€™Ordine i casi di abusivismo o di usurpazione di titolo di cui viene a conoscenza. Parimenti, utilizza il proprio titolo professionale esclusivamente per attivitÃ  ad esso pertinenti, e non avalla con esso attivitÃ  ingannevoli od abusive."}, {"num": 9, "text": "Nella sua attivitÃ  di ricerca lo psicologo Ã¨ tenuto ad informare adeguatamente i soggetti in essa coinvolti al fine di ottenerne il previo consenso informato, anche relativamente al nome, allo status scientifico e professionale del ricercatore ed alla sua eventuale istituzione di appartenenza. Egli deve altresÃ¬ garantire a tali soggetti la piena libertÃ  di concedere, di rifiutare ovvero di ritirare il consenso stesso. Nellâ€™ipotesi in cui la natura della ricerca non consenta di informare preventivamente e correttamente i soggetti su taluni aspetti della ricerca stessa, lo psicologo ha lâ€™obbligo di fornire comunque, alla fine della prova ovvero della raccolta dei dati, le informazioni dovute e di ottenere lâ€™autorizzazione allâ€™uso dei dati raccolti. Per quanto concerne i soggetti che, per etÃ  o per altri motivi, non sono in grado di esprimere validamente il loro consenso, questo deve essere dato da chi ne ha la potestÃ  genitoriale o la tutela, e, altresÃ¬, dai soggetti stessi, ove siano in grado di comprendere la natura della collaborazione richiesta. Deve essere tutelato, in ogni caso, il diritto dei soggetti alla riservatezza, alla non riconoscibilitÃ  ed allâ€™anonimato."}, {"num": 10, "text": "Quando le attivitÃ  professionali hanno ad oggetto il comportamento degli animali, lo psicologo si impegna a rispettarne la natura ed a evitare loro sofferenze."}, {"num": 11, "text": "Lo psicologo Ã¨ strettamente tenuto al segreto professionale. Pertanto non rivela notizie, fatti o informazioni apprese in ragione del suo rapporto professionale, nÃ© informa circa le prestazioni professionali effettuate o programmate, a meno che non ricorrano le ipotesi previste dagli articoli seguenti."}, {"num": 12, "text": "Lo psicologo si astiene dal rendere testimonianza su fatti di cui Ã¨ venuto a conoscenza in ragione del suo rapporto professionale. Lo psicologo puÃ² derogare allâ€™obbligo di mantenere il segreto professionale, anche in caso di testimonianza, esclusivamente in presenza di valido e dimostrabile consenso del destinatario della sua prestazione. Valuta, comunque, lâ€™opportunitÃ  di fare uso di tale consenso, considerando preminente la tutela psicologica dello stesso."}, {"num": 13, "text": "Nel caso di obbligo di referto o di obbligo di denuncia, lo psicologo limita allo stretto necessario il riferimento di quanto appreso in ragione del proprio rapporto professionale, ai fini della tutela psicologica del soggetto. Negli altri casi, valuta con attenzione la necessitÃ  di derogare totalmente o parzialmente alla propria doverosa riservatezza, qualora si prospettino gravi pericoli per la vita o per la salute psicofisica del soggetto e/o di terzi."}, {"num": 14, "text": "Lo psicologo, nel caso di intervento su o attraverso gruppi, Ã¨ tenuto ad in informare, nella fase iniziale, circa le regole che governano tale intervento. Ãˆ tenuto altresÃ¬ ad impegnare, quando necessario, i componenti del gruppo al rispetto del diritto di ciascuno alla riservatezza."}, {"num": 15, "text": "Nel caso di collaborazione con altri soggetti parimenti tenuti al segreto professionale, lo psicologo puÃ² condividere soltanto le informazioni strettamente necessarie in relazione al tipo di collaborazione."}, {"num": 16, "text": "Lo psicologo redige le comunicazioni scientifiche, ancorchÃ© indirizzate ad un pubblico di professionisti tenuti al segreto professionale, in modo da salvaguardare in ogni caso lâ€™anonimato del destinatario della prestazione."}, {"num": 17, "text": "La segretezza delle comunicazioni deve essere protetta anche attraverso la custodia e il controllo di appunti, note, scritti o registrazioni di qualsiasi genere e sotto qualsiasi forma, che riguardino il rapporto professionale. Tale documentazione deve essere conservata per almeno i cinque anni successivi alla conclusione del rapporto professionale, fatto salvo quanto previsto da norme specifiche. Lo psicologo deve provvedere perchÃ©, in caso di sua morte o di suo impedimento, tale protezione sia affidata ad un collega ovvero allâ€™Ordine professionale. Lo psicologo che collabora alla costituzione ed allâ€™uso di sistemi di documentazione si adopera per la realizzazione di garanzie di tutela dei soggetti interessati."}, {"num": 18, "text": "In ogni contesto professionale lo psicologo deve adoperarsi affinchÃ© sia il piÃ¹ possibile rispettata la libertÃ  di scelta, da parte del cliente e/o del paziente, del professionista cui rivolgersi."}, {"num": 19, "text": "Lo psicologo che presta la sua opera professionale in contesti di selezione e valutazione Ã¨ tenuto a rispettare esclusivamente i criteri della specifica competenza, qualificazione o preparazione, e non avalla decisioni contrarie a tali principi."}, {"num": 20, "text": "Nella sua attivitÃ  di docenza, di didattica e di formazione lo psicologo stimola negli studenti, allievi e tirocinanti lâ€™interesse per i principi deontologici, anche ispirando ad essi la propria condotta professionale."}, {"num": 21, "text": "Lâ€™insegnamento dellâ€™uso di strumenti e tecniche conoscitive e di intervento riservati alla professione di psicologo a persone estranee alla professione stessa costituisce violazione deontologica grave. Costituisce aggravante avallare con la propria opera professionale attivitÃ  ingannevoli o abusive concorrendo allâ€™attribuzione di qualifiche, attestati o inducendo a ritenersi autorizzati allâ€™esercizio di attivitÃ  caratteristiche dello psicologo. Sono specifici della professione di psicologo tutti gli strumenti e le tecniche conoscitive e di intervento relative a processi psichici (relazionali, emotivi, cognitivi, comportamentali) basati sullâ€™applicazione di principi, conoscenze, modelli o costrutti psicologici. Ãˆ fatto salvo lâ€™insegnamento di tali strumenti e tecniche agli studenti dei corsi di studio universitari in psicologia e ai tirocinanti. Ãˆ altresÃ¬ fatto salvo lâ€™insegnamento di conoscenze psicologiche."}, {"num": 22, "text": "Lo psicologo adotta condotte non lesive per le persone di cui si occupa professionalmente, e non utilizza il proprio ruolo ed i propri strumenti professionali per assicurare a sÃ¨ o ad altri indebiti vantaggi."}, {"num": 23, "text": "Lo psicologo pattuisce nella fase iniziale del rapporto quanto attiene al compenso professionale. In ogni caso la misura del compenso deve essere adeguata allâ€™importanza dellâ€™opera. In ambito clinico tale compenso non puÃ² essere condizionato allâ€™esito o ai risultati dellâ€™intervento professionale."}, {"num": 24, "text": "Lo psicologo, nella fase iniziale del rapporto professionale, fornisce allâ€™individuo, al gruppo, allâ€™istituzione o alla comunitÃ , siano essi utenti o committenti, informazioni adeguate e comprensibili circa le sue prestazioni, le finalitÃ  e le modalitÃ  delle stesse, nonchÃ© circa il grado e i limiti giuridici della riservatezza. Pertanto, opera in modo che chi ne ha diritto possa esprimere un consenso informato. Se la prestazione professionale ha carattere di continuitÃ  nel tempo, dovrÃ  esserne indicata, ove possibile, la prevedibile durata."}, {"num": 25, "text": "Lo psicologo non usa impropriamente gli strumenti di diagnosi e di valutazione di cui dispone. Nel caso di interventi commissionati da terzi, informa i soggetti circa la natura del suo intervento professionale, e non utilizza, se non nei limiti del mandato ricevuto, le notizie apprese che possano recare ad essi pregiudizio. Nella comunicazione dei risultati dei propri interventi diagnostici e valutativi, lo psicologo Ã¨ tenuto a regolare tale comunicazione anche in relazione alla tutela psicologica dei soggetti."}, {"num": 26, "text": "Lo psicologo si astiene dallâ€™intraprendere o dal proseguire qualsiasi attivitÃ  professionale ove propri problemi o conflitti personali, interferendo con lâ€™efficacia delle sue prestazioni, le rendano inadeguate o dannose alle persone cui sono rivolte. Lo psicologo evita, inoltre, di assumere ruoli professionali e di compiere interventi nei confronti dellâ€™utenza, anche su richiesta dellâ€™AutoritÃ  Giudiziaria, qualora la natura di precedenti rapporti possa comprometterne la credibilitÃ  e lâ€™efficacia."}, {"num": 27, "text": "Lo psicologo valuta ed eventualmente propone lâ€™interruzione del rapporto terapeutico quando constata che il paziente non trae alcun beneficio dalla cura e non Ã¨ ragionevolmente prevedibile che ne trarrÃ  dal proseguimento della cura stessa. Se richiesto, fornisce al paziente le informazioni necessarie a ricercare altri e piÃ¹ adatti interventi."}, {"num": 28, "text": "Lo psicologo evita commistioni tra il ruolo professionale e vita privata che possano interferire con lâ€™attivitÃ  professionale o comunque arrecare nocumento allâ€™immagine sociale della professione. Costituisce grave violazione deontologica effettuare interventi diagnostici, di sostegno psicologico o di psicoterapia rivolti a persone con le quali ha intrattenuto o intrattiene relazioni significative di natura personale, in particolare di natura affettivo-sentimentale e/o sessuale. Parimenti costituisce grave violazione deontologica instaurare le suddette relazioni nel corso del rapporto professionale. Allo psicologo Ã¨ vietata qualsiasi attivitÃ  che, in ragione del rapporto professionale, possa produrre per lui indebiti vantaggi diretti o indiretti di carattere patrimoniale o non patrimoniale, ad esclusione del compenso pattuito. Lo psicologo non sfrutta la posizione professionale che assume nei confronti di colleghi in supervisione e di tirocinanti, per fini estranei al rapporto professionale."}, {"num": 29, "text": "Lo psicologo puÃ² subordinare il proprio intervento alla condizione che il paziente si serva di determinati presidi, istituti o luoghi di cura soltanto per fondati motivi di natura scientifico-professionale."}, {"num": 30, "text": "Nellâ€™esercizio della sua professione allo psicologo Ã¨ vietata qualsiasi forma di compenso che non costituisca il corrispettivo di prestazioni professionali."}, {"num": 31, "text": "Le prestazioni professionali a persone minorenni o interdette sono, generalmente, subordinate al consenso di chi esercita sulle medesime la potestÃ  genitoriale o la tutela. Lo psicologo che, in assenza del consenso di cui al precedente comma, giudichi necessario lâ€™intervento professionale nonchÃ© lâ€™assoluta riservatezza dello stesso, Ã¨ tenuto ad informare lâ€™AutoritÃ  Tutoria dellâ€™instaurarsi della relazione professionale. Sono fatti salvi i casi in cui tali prestazioni avvengano su ordine dellâ€™autoritÃ  legalmente competente o in strutture legislativamente preposte."}, {"num": 32, "text": "Quando lo psicologo acconsente a fornire una prestazione professionale su richiesta di un committente diverso dal destinatario della prestazione stessa, Ã¨ tenuto a chiarire con le parti in causa la natura e le finalitÃ  dellâ€™intervento."}, {"num": 33, "text": "I rapporti fra gli psicologi devono ispirarsi al principio del rispetto reciproco, della lealtÃ  e della colleganza. Lo psicologo appoggia e sostiene i Colleghi che, nellâ€™ambito della propria attivitÃ , quale che sia la natura del loro rapporto di lavoro e la loro posizione gerarchica, vedano compromessa la loro autonomia ed il rispetto delle norme deontologiche."}, {"num": 34, "text": "Lo psicologo si impegna a contribuire allo sviluppo delle discipline psicologiche e a comunicare i progressi delle sue conoscenze e delle sue tecniche alla comunitÃ  professionale, anche al fine di favorirne la diffusione per scopi di benessere umano e sociale."}, {"num": 35, "text": "Nel presentare i risultati delle proprie ricerche, lo psicologo Ã¨ tenuto ad indicare la fonte degli altrui contributi."}, {"num": 36, "text": "Lo psicologo si astiene dal dare pubblicamente su colleghi giudizi negativi relativi alla loro formazione, alla loro competenza ed ai risultati conseguiti a seguito di interventi professionali, o comunque giudizi lesivi del loro decoro e della loro reputazione professionale. Costituisce aggravante il fatto che tali giudizi negativi siano volti a sottrarre clientela ai colleghi. Qualora ravvisi casi di scorretta condotta professionale che possano tradursi in danno per gli utenti o per il decoro della professione, lo psicologo Ã¨ tenuto a darne tempestiva comunicazione al Consiglio dellâ€™Ordine competente."}, {"num": 37, "text": "Lo psicologo accetta il mandato professionale esclusivamente nei limiti delle proprie competenze. Qualora lâ€™interesse del committente e/o del destinatario della prestazione richieda il ricorso ad altre specifiche competenze, lo psicologo propone la consulenza ovvero lâ€™invio ad altro collega o ad altro professionista."}, {"num": 38, "text": "Nellâ€™esercizio della propria attivitÃ  professionale e nelle circostanze in cui rappresenta pubblicamente la professione a qualsiasi titolo, lo psicologo Ã¨ tenuto ad uniformare la propria condotta ai principi del decoro e della dignitÃ  professionale."}, {"num": 39, "text": "Lo psicologo presenta in modo corretto ed accurato la propria formazione, esperienza e competenza. Riconosce quale suo dovere quello di aiutare il pubblico e gli utenti a sviluppare in modo libero e consapevole giudizi, opinioni e scelte."}, {"num": 40, "text": "Indipendentemente dai limiti posti dalla vigente legislazione in materia di pubblicitÃ , lo psicologo non assume pubblicamente comportamenti scorretti finalizzati al procacciamento della clientela. In ogni caso, puÃ² essere svolta pubblicitÃ  informativa circa i titoli e le specializzazioni professionali, le caratteristiche del servizio offerto, nonchÃ© il prezzo e i costi complessivi delle prestazioni secondo criteri di trasparenza e veridicitÃ  del messaggio il cui rispetto Ã¨ verificato dai competenti Consigli dellâ€™Ordine. Il messaggio deve essere formulato nel rispetto del decoro professionale, conformemente ai criteri di serietÃ  scientifica ed alla tutela dellâ€™immagine della professione. La mancanza di trasparenza e veridicitÃ  del messaggio pubblicizzato costituisce violazione deontologica."}, {"num": 41, "text": "Ãˆ istituito presso la â€œCommissione Deontologiaâ€ dellâ€™Ordine degli psicologi lâ€™â€Osservatorio permanente sul Codice Deontologicoâ€, regolamentato con apposito atto del Consiglio Nazionale dellâ€™Ordine, con il compito di raccogliere la giurisprudenza in materia deontologica dei Consigli regionali e provinciali dellâ€™Ordine e ogni altro materiale utile a formulare eventuali proposte della Commissione al Consiglio Nazionale dellâ€™Ordine, anche ai fini della revisione periodica del Codice Deontologico. Tale revisione si atterrÃ  alle modalitÃ  previste dalla Legge 18 febbraio 1989, n. 56."}, {"num": 42, "text": "Il presente Codice deontologico entra in vigore il trentesimo giorno successivo alla proclamazi"}];

  // PRNG deterministico (LCG) per test stabili
  function LCG(seed) { let s = seed >>> 0; return function(){ s = (1664525 * s + 1013904223) >>> 0; return s / 2**32; }; }
  function pickKExcept(rng, total, exclude, k) { // numeri 1..total escluso 'exclude'
    const pool = []; for(let i=1;i<=total;i++) if(i!==exclude) pool.push(i);
    const out = [];
    while(out.length<k && pool.length>0){
      const idx = Math.floor(rng()*pool.length);
      out.push(pool.splice(idx,1)[0]);
    }
    return out;
  }
  function shuffleWithRng(arr, rng){
    const a = [...arr];
    for(let i=a.length-1;i>0;i--){ const j=Math.floor(rng()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
    return a;
  }

  // Genera i 5 test Aâ€“E con ordine delle domande mescolato
  const seeds = {"A":111, "B":222, "C":333, "D":444, "E":555};
  const tests = {};
  for (const [label,seed] of Object.entries(seeds)) {
    const rng = LCG(seed);
    const qs = [];
    // ðŸ‘‡ mescola l'ordine degli articoli per questo test
    const artsShuffled = shuffleWithRng(ARTICOLI, rng);
    for (const art of artsShuffled) {
      const correct = art.num;
      const distractors = pickKExcept(rng, 42, correct, 3);
      const options = shuffleWithRng([correct, ...distractors], rng).map(n => ({label:"Articolo "+n, value:n}));
      const correctIdx = options.findIndex(o => o.value===correct);
      qs.push({ id:label+"-"+correct, ref:"Articolo "+correct, text:art.text, options, correct:correctIdx });
    }
    tests[label] = qs; // qs Ã¨ giÃ  in ordine mescolato
  }


  const tabs = document.getElementById('test-tabs');
  const app = document.getElementById('app');
  const tpl = document.getElementById('tpl');

  function storageKey(label){ return "riconosc_art_"+label; }
  function save(label,data){ localStorage.setItem(storageKey(label), JSON.stringify(data)); }
  function load(label,def){ try{ return JSON.parse(localStorage.getItem(storageKey(label))) ?? def; }catch(e){ return def; } }

  function renderTabs(active='A'){
    tabs.innerHTML='';
    for(const label of Object.keys(tests)){
      const b=document.createElement('button');
      b.className='tab'+(label===active?' active':'');
      b.textContent="Test "+label;
      b.addEventListener('click',()=>openTest(label));
      tabs.appendChild(b);
    }
  }

  function openTest(label){
    renderTabs(label);
    app.innerHTML='';
    const node = tpl.content.cloneNode(true);
    node.querySelector('h2').textContent = "Test "+label+" â€” 42 domande";
    const box = node.querySelector('.questions');
    const scoreEl = node.querySelector('[data-score]');
    const totalEl = node.querySelector('[data-total]');
    const data = tests[label];
    totalEl.textContent = data.length;

    const state = load(label, {answers:{}});

    function score(){ let s=0; for(const q of data){ if(Number(state.answers[q.id])===q.correct) s++; } return s; }
    function build(){
      box.innerHTML='';
      data.forEach((q,idx)=>{
        const c=document.createElement('div'); 
        c.className='card';
    
        // Titolo della domanda SENZA riferimento allâ€™articolo
        const h=document.createElement('div'); 
        h.className='ref'; 
        h.textContent = "Domanda "+(idx+1);
    
        const t=document.createElement('div'); 
        t.className='qtext'; 
        t.textContent = q.text;
        
        const opts=document.createElement('div'); opts.className='opts';
        q.options.forEach((o,i)=>{ 
          const lab=document.createElement('label'); lab.className='opt';
          const inp=document.createElement('input'); inp.type='radio'; inp.name=q.id; inp.value=i; inp.style.marginTop='4px';
          if(String(state.answers[q.id])===String(i)) inp.checked=true;
          lab.appendChild(inp);
          const span=document.createElement('span'); span.textContent = "ABCD".charAt(i)+") "+o.label; lab.appendChild(span);
          lab.addEventListener('click', (e)=>{ if(e.target.tagName.toLowerCase()!=='input') inp.checked=true; state.answers[q.id]=i; save(label,state); scoreEl.textContent = score(); });
          opts.appendChild(lab);
        });
        c.appendChild(h); c.appendChild(t); c.appendChild(opts); box.appendChild(c);
      });
    }

    node.querySelector('[data-action="check"]').addEventListener('click',()=>{
      [...box.querySelectorAll('.card')].forEach((card,idx)=>{
        const q = data[idx];
        const opts = card.querySelectorAll('.opt');
        opts.forEach((o,i)=>{
          o.classList.remove('correct','wrong');
          if(i===q.correct) o.classList.add('correct');
          const chosen = Number(state.answers[q.id]);
          if(!isNaN(chosen) && i===chosen && chosen!==q.correct) o.classList.add('wrong');
        });
      });
      scoreEl.textContent = score();
    });

    node.querySelector('[data-action="reset"]').addEventListener('click',()=>{
      state.answers={}; save(label,state); build();
    });

    node.querySelector('[data-action="export"]').addEventListener('click',()=>{
      const rows=[["ID","Rif","Domanda (testo)","Opzioni","Corretta(A-D)","Scelta(A-D)"]];
      data.forEach(q=>{
        const correctLetter = "ABCD".charAt(q.correct);
        const chosenIdx = Number(state.answers[q.id]);
        const chosenLetter = isNaN(chosenIdx)? "": "ABCD".charAt(chosenIdx);
        rows.push([q.id,q.ref,q.text,q.options.map((o,i)=>("ABCD".charAt(i)+") "+o.label)).join(" | "),correctLetter,chosenLetter]);
      });
      const csv = rows.map(r=>r.map(v=>'"'+String(v).replaceAll('"','""')+'"').join(',')).join('\n');
      const blob = new Blob([csv],{type:'text/csv'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = "test_"+label+".csv";
      a.click();
    });

    app.appendChild(node);
    build();
  }

  renderTabs('A');
  openTest('A');
</script>
</body>
</html>
